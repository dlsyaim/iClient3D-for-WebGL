<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">  <!-- Use Chrome Frame in IE -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <meta name="description" content="view osgb model.">
    <meta name="cesium-sandcastle-labels" content="Development">
    <title>Cesium Demo</title>
    <script type="text/javascript" src="../Sandcastle-header.js"></script>
    <script type="text/javascript" src="../../../ThirdParty/requirejs-2.1.9/require.js"></script>
    <script type="text/javascript">
        require.config({
            baseUrl : '../../../Source',
            waitSeconds : 60
        });
    </script>
</head>
<body class="sandcastle-loading" data-sandcastle-bucket="bucket-requirejs.html">
<style>
    @import url(../templates/bucket.css);
</style>
<div id="cesiumContainer" class="fullSize"></div>
<div id="loadingOverlay"><h1>Loading...</h1></div>
<div id="toolbar"></div>
<script id="cesium_sandcastle_script">
    function startup(Cesium) {
        "use strict";
//Sandcastle_Begin
// Create the viewer.

        /*var LONGITUDE = 13.0518640714;//经度
        var LATITUDE = 47.8179189759;//纬度*/
        var LONGITUDE = 115.167986191511;//经度
        var LATITUDE = 23.6333190300878;//纬度
        var PATH = "http://localhost:8090/OSGData/";//S3M数据路径路径
        var SERVER = "http://localhost:8090";
        var PREFIX = 'SRSBDDS';//文件夹名称

        var viewer = new Cesium.Viewer('cesiumContainer',{
            animation : false,
            timeline : false,
            homeButton : false,
            //geocoder : false,
            /*imageryProvider : new Cesium.ArcGisMapServerImageryProvider({
                url: '//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer'
            }),*/
            /*imageryProvider : new Cesium.GoogleEarthImageryProvider({
                url : 'http://khm1.google.com/kh/v=189',
                channel : 1008
            }),*/
            baseLayerPicker : false
        });
        var cesiumTerrainProviderMeshes = new Cesium.CesiumTerrainProvider({
            url : 'http://localhost:8090/Terrain',
            requestWaterMask : true,
            requestVertexNormals : true
        });
        viewer.terrainProvider = cesiumTerrainProviderMeshes;
        var scene = viewer.scene;
        var camera = scene.camera;

        /*var osgbData = {
             urls : [
             PATH + PREFIX + "/Tile_001_001/Tile_001_001.xml",
             PATH + PREFIX + "/Tile_001_002/Tile_001_002.xml",
             PATH + PREFIX + "/Tile_001_003/Tile_001_003.xml",
             PATH + PREFIX + "/Tile_001_004/Tile_001_004.xml",
             PATH + PREFIX + "/Tile_001_005/Tile_001_005.xml",
             PATH + PREFIX + "/Tile_001_006/Tile_001_006.xml",

             PATH + PREFIX + "/Tile_002_001/Tile_002_001.xml",
             PATH + PREFIX + "/Tile_002_002/Tile_002_002.xml",
             PATH + PREFIX + "/Tile_002_003/Tile_002_003.xml",
             PATH + PREFIX + "/Tile_002_004/Tile_002_004.xml",
             PATH + PREFIX + "/Tile_002_005/Tile_002_005.xml",
             PATH + PREFIX + "/Tile_002_006/Tile_002_006.xml",

             PATH + PREFIX + "/Tile_003_001/Tile_003_001.xml",
             PATH + PREFIX + "/Tile_003_002/Tile_003_002.xml",
             PATH + PREFIX + "/Tile_003_003/Tile_003_003.xml",
             PATH + PREFIX + "/Tile_003_004/Tile_003_004.xml",
             PATH + PREFIX + "/Tile_003_005/Tile_003_005.xml",
             PATH + PREFIX + "/Tile_003_006/Tile_003_006.xml",

             PATH + PREFIX + "/Tile_004_001/Tile_004_001.xml",
             PATH + PREFIX + "/Tile_004_002/Tile_004_002.xml",
             PATH + PREFIX + "/Tile_004_003/Tile_004_003.xml",
             PATH + PREFIX + "/Tile_004_004/Tile_004_004.xml",
             PATH + PREFIX + "/Tile_004_005/Tile_004_005.xml",
             PATH + PREFIX + "/Tile_004_006/Tile_004_006.xml",

             PATH + PREFIX + "/Tile_005_001/Tile_005_001.xml",
             PATH + PREFIX + "/Tile_005_002/Tile_005_002.xml",
             PATH + PREFIX + "/Tile_005_003/Tile_005_003.xml",
             PATH + PREFIX + "/Tile_005_004/Tile_005_004.xml",
             PATH + PREFIX + "/Tile_005_005/Tile_005_005.xml",
             PATH + PREFIX + "/Tile_005_006/Tile_005_006.xml"
             ],
             //position :  [13.0518640714,47.8179189759,-60],
             position :  [LONGITUDE,LATITUDE],
             servers : [
             SERVER
             ]
         };*/

        /*var osgbData = {
            urls : [
                        PATH + "MaSai/Tile_008_005/Tile_008_005.xml",
                        PATH + "MaSai/Tile_008_006/Tile_008_006.xml",
                        PATH + "MaSai/Tile_009_005/Tile_009_005.xml",
                        PATH + "MaSai/Tile_009_006/Tile_009_006.xml"
            ],
            position :  [5.37,43.296388888889],
            //position :  [LONGITUDE,LATITUDE],
            servers : [
                SERVER
            ]
        };*/

        /*var osgbData = {
            urls : [
                        PATH + "G2_S3M1/Tile_004_002/Tile_004_002.xml",
                        PATH + "G2_S3M1/Tile_004_003/Tile_004_003.xml",
                        PATH + "G2_S3M1/Tile_005_002/Tile_005_002.xml",
                        PATH + "G2_S3M1/Tile_005_003/Tile_005_003.xml"
            ],
            position :  [117.03576,36.67659],
            //position :  [LONGITUDE,LATITUDE],
            servers : [
                SERVER
            ]
        };*/

        var osgbData = {
            urls : [
                        PATH + 'ZJ/Tile_018_009/Tile_018_009.xml',
                        PATH + "ZJ/Tile_018_009/Tile_018_009.xml",
                        PATH + "ZJ/Tile_018_010/Tile_018_010.xml",
                        PATH + "ZJ/Tile_018_011/Tile_018_011.xml",
                        PATH + "ZJ/Tile_018_012/Tile_018_012.xml",
                        PATH + "ZJ/Tile_018_013/Tile_018_013.xml",
                        PATH + "ZJ/Tile_018_014/Tile_018_014.xml",
                        PATH + "ZJ/Tile_019_009/Tile_019_009.xml",
                        PATH + "ZJ/Tile_019_010/Tile_019_010.xml",
                        PATH + "ZJ/Tile_019_011/Tile_019_011.xml",
                        PATH + "ZJ/Tile_019_012/Tile_019_012.xml",
                        PATH + "ZJ/Tile_019_013/Tile_019_013.xml",
                        PATH + "ZJ/Tile_019_014/Tile_019_014.xml",
                        PATH + "ZJ/Tile_019_015/Tile_019_015.xml",
                        PATH + "ZJ/Tile_020_009/Tile_020_009.xml",
                        PATH + "ZJ/Tile_020_010/Tile_020_010.xml",
                        PATH + "ZJ/Tile_020_011/Tile_020_011.xml",
                        PATH + "ZJ/Tile_020_012/Tile_020_012.xml",
                        PATH + "ZJ/Tile_020_013/Tile_020_013.xml",
                        PATH + "ZJ/Tile_020_014/Tile_020_014.xml",
                        PATH + "ZJ/Tile_020_015/Tile_020_015.xml",
                        PATH + "ZJ/Tile_020_016/Tile_020_016.xml",
                        PATH + "ZJ/Tile_021_009/Tile_021_009.xml",
                        PATH + "ZJ/Tile_021_010/Tile_021_010.xml",
                        PATH + "ZJ/Tile_021_011/Tile_021_011.xml",
                        PATH + "ZJ/Tile_021_012/Tile_021_012.xml",
                        PATH + "ZJ/Tile_021_013/Tile_021_013.xml",
                        PATH + "ZJ/Tile_021_014/Tile_021_014.xml",
                        PATH + "ZJ/Tile_021_015/Tile_021_015.xml",
                        PATH + "ZJ/Tile_021_016/Tile_021_016.xml",
                        PATH + "ZJ/Tile_022_010/Tile_022_010.xml",
                        PATH + "ZJ/Tile_022_011/Tile_022_011.xml",
                        PATH + "ZJ/Tile_022_012/Tile_022_012.xml",
                        PATH + "ZJ/Tile_022_013/Tile_022_013.xml",
                        PATH + "ZJ/Tile_022_014/Tile_022_014.xml",
                        PATH + "ZJ/Tile_022_015/Tile_022_015.xml",
                        PATH + "ZJ/Tile_022_016/Tile_022_016.xml",
                        PATH + "ZJ/Tile_022_017/Tile_022_017.xml",
                        PATH + "ZJ/Tile_023_010/Tile_023_010.xml",
                        PATH + "ZJ/Tile_023_011/Tile_023_011.xml",
                        PATH + "ZJ/Tile_023_012/Tile_023_012.xml",
                        PATH + "ZJ/Tile_023_013/Tile_023_013.xml",
                        PATH + "ZJ/Tile_023_014/Tile_023_014.xml",
                        PATH + "ZJ/Tile_023_015/Tile_023_015.xml",
                        PATH + "ZJ/Tile_023_016/Tile_023_016.xml",
                        PATH + "ZJ/Tile_023_017/Tile_023_017.xml",
                        PATH + "ZJ/Tile_024_010/Tile_024_010.xml",
                        PATH + "ZJ/Tile_024_011/Tile_024_011.xml",
                        PATH + "ZJ/Tile_024_012/Tile_024_012.xml",
                        PATH + "ZJ/Tile_024_013/Tile_024_013.xml",
                        PATH + "ZJ/Tile_024_014/Tile_024_014.xml",
                        PATH + "ZJ/Tile_024_015/Tile_024_015.xml",
                        PATH + "ZJ/Tile_024_016/Tile_024_016.xml",
                        PATH + "ZJ/Tile_024_017/Tile_024_017.xml",
                        PATH + "ZJ/Tile_024_018/Tile_024_018.xml",
                        PATH + "ZJ/Tile_025_010/Tile_025_010.xml",
                        PATH + "ZJ/Tile_025_011/Tile_025_011.xml",
                        PATH + "ZJ/Tile_025_012/Tile_025_012.xml",
                        PATH + "ZJ/Tile_025_013/Tile_025_013.xml",
                        PATH + "ZJ/Tile_025_014/Tile_025_014.xml",
                        PATH + "ZJ/Tile_025_015/Tile_025_015.xml",
                        PATH + "ZJ/Tile_025_016/Tile_025_016.xml",
                        PATH + "ZJ/Tile_025_017/Tile_025_017.xml",
                        PATH + "ZJ/Tile_025_018/Tile_025_018.xml",
                        PATH + "ZJ/Tile_025_019/Tile_025_019.xml",
                        PATH + "ZJ/Tile_026_010/Tile_026_010.xml",
                        PATH + "ZJ/Tile_026_011/Tile_026_011.xml",
                        PATH + "ZJ/Tile_026_012/Tile_026_012.xml",
                        PATH + "ZJ/Tile_026_013/Tile_026_013.xml",
                        PATH + "ZJ/Tile_026_014/Tile_026_014.xml",
                        PATH + "ZJ/Tile_026_015/Tile_026_015.xml",
                        PATH + "ZJ/Tile_026_016/Tile_026_016.xml",
                        PATH + "ZJ/Tile_026_017/Tile_026_017.xml",
                        PATH + "ZJ/Tile_026_018/Tile_026_018.xml",
                        PATH + "ZJ/Tile_026_019/Tile_026_019.xml",
                        PATH + "ZJ/Tile_027_010/Tile_027_010.xml",
                        PATH + "ZJ/Tile_027_011/Tile_027_011.xml",
                        PATH + "ZJ/Tile_027_012/Tile_027_012.xml",
                        PATH + "ZJ/Tile_027_013/Tile_027_013.xml",
                        PATH + "ZJ/Tile_027_014/Tile_027_014.xml",
                        PATH + "ZJ/Tile_027_015/Tile_027_015.xml",
                        PATH + "ZJ/Tile_027_016/Tile_027_016.xml",
                        PATH + "ZJ/Tile_027_017/Tile_027_017.xml",
                        PATH + "ZJ/Tile_027_018/Tile_027_018.xml",
                        PATH + "ZJ/Tile_027_019/Tile_027_019.xml",
                        PATH + "ZJ/Tile_028_010/Tile_028_010.xml",
                        PATH + "ZJ/Tile_028_011/Tile_028_011.xml",
                        PATH + "ZJ/Tile_028_012/Tile_028_012.xml",
                        PATH + "ZJ/Tile_028_013/Tile_028_013.xml",
                        PATH + "ZJ/Tile_028_014/Tile_028_014.xml",
                        PATH + "ZJ/Tile_028_015/Tile_028_015.xml",
                        PATH + "ZJ/Tile_028_016/Tile_028_016.xml",
                        PATH + "ZJ/Tile_028_017/Tile_028_017.xml",
                        PATH + "ZJ/Tile_028_018/Tile_028_018.xml",
                        PATH + "ZJ/Tile_028_019/Tile_028_019.xml",
                        PATH + "ZJ/Tile_029_009/Tile_029_009.xml",
                        PATH + "ZJ/Tile_029_010/Tile_029_010.xml",
                        PATH + "ZJ/Tile_029_011/Tile_029_011.xml",
                        PATH + "ZJ/Tile_029_012/Tile_029_012.xml",
                        PATH + "ZJ/Tile_029_013/Tile_029_013.xml",
                        PATH + "ZJ/Tile_029_014/Tile_029_014.xml",
                        PATH + "ZJ/Tile_029_015/Tile_029_015.xml",
                        PATH + "ZJ/Tile_029_016/Tile_029_016.xml",
                        PATH + "ZJ/Tile_029_017/Tile_029_017.xml",
                        PATH + "ZJ/Tile_029_018/Tile_029_018.xml",
                        PATH + "ZJ/Tile_029_019/Tile_029_019.xml",
                        PATH + "ZJ/Tile_030_007/Tile_030_007.xml",
                        PATH + "ZJ/Tile_030_009/Tile_030_009.xml",
                        PATH + "ZJ/Tile_030_010/Tile_030_010.xml",
                        PATH + "ZJ/Tile_030_011/Tile_030_011.xml",
                        PATH + "ZJ/Tile_030_012/Tile_030_012.xml",
                        PATH + "ZJ/Tile_030_013/Tile_030_013.xml",
                        PATH + "ZJ/Tile_030_014/Tile_030_014.xml",
                        PATH + "ZJ/Tile_030_015/Tile_030_015.xml",
                        PATH + "ZJ/Tile_030_016/Tile_030_016.xml",
                        PATH + "ZJ/Tile_030_017/Tile_030_017.xml",
                        PATH + "ZJ/Tile_030_018/Tile_030_018.xml",
                        PATH + "ZJ/Tile_030_019/Tile_030_019.xml",
                        PATH + "ZJ/Tile_031_009/Tile_031_009.xml",
                        PATH + "ZJ/Tile_031_010/Tile_031_010.xml",
                        PATH + "ZJ/Tile_031_011/Tile_031_011.xml",
                        PATH + "ZJ/Tile_031_012/Tile_031_012.xml",
                        PATH + "ZJ/Tile_031_013/Tile_031_013.xml",
                        PATH + "ZJ/Tile_031_014/Tile_031_014.xml",
                        PATH + "ZJ/Tile_031_015/Tile_031_015.xml",
                        PATH + "ZJ/Tile_031_016/Tile_031_016.xml",
                        PATH + "ZJ/Tile_031_017/Tile_031_017.xml",
                        PATH + "ZJ/Tile_031_018/Tile_031_018.xml",
                        PATH + "ZJ/Tile_031_019/Tile_031_019.xml"
            ],
            //position :  [13.0518640714,47.8179189759,-60],
            position :  [115.167986191511,23.6333190300878,-30],
            servers : [
                SERVER
            ]
        };
        //scene.globe.enableLighting = true;
        camera.flyTo({
            destination : Cesium.Cartesian3.fromDegrees(LONGITUDE,LATITUDE, 1000),
            orientation : {
                heading : Cesium.Math.toRadians(200.0),
                pitch : Cesium.Math.toRadians(-50.0)
            },
            duration : 5,
            easingFunction : Cesium.EasingFunction.LINEAR_NONE,
            complete : function() {
                setTimeout(function() {
                    scene.addOsgbLayer(osgbData);
                    //scene.addOsbgLayerByScp('http://localhost:8090/iserver/services/3D-srsb2/rest/realspace/datas/SRSB/config');
                }, 1000);
            }
        });

        //测试float编码成4个int的算法
        function test(){
            var d = 1.41973;
            var x = d*1.0;
            var y = d*255.0;
            var z = d*65025.0;
            var w = d*16581375.0;
            var xf = Math.floor(x);
            var yf = Math.floor(y);
            var zf = Math.floor(z);
            var wf = Math.floor(w);
            x = x - xf;
            y = y - yf;
            z = z - zf;
            w = w - wf;
            x = (x - y/255.0)*255.0;
            y = (y - z/255.0)*255.0;
            z = (z - w/255.0)*255.0;
            w = w*255.0;
            x /= 255.0;
            y /= 255.0;
            z /= 255.0;
            w /= 255.0;
            var res = x + y/255.0 + z/65025.0 + w/16581375.0;
        }


//Sandcastle_End
        Sandcastle.finishedLoading();
    }
    if (typeof Cesium !== "undefined") {
        startup(Cesium);
    } else if (typeof require === "function") {
        require(["Cesium"], startup);
    }
</script>
</body>
</html>
